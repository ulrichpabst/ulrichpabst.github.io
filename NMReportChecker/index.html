<!DOCTYPE html>
<html lang="en" data-theme="">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>NMReportChecker</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="site-header">
    <div class="wrap header-bar">
      <div class="brand">
        <h1>NMReportChecker</h1>
        <div class="byline"></div>
      </div>

<div class="theme-toggle" id="themeToggle" title="Toggle theme">
  <span class="theme-toggle-sr">Toggle theme</span>

  <svg xmlns="http://www.w3.org/2000/svg"
       aria-hidden="true"
       width="1em" height="1em"
       fill="currentColor"
       class="theme-toggle__expand"
       viewBox="0 0 32 32">
    <clipPath id="theme-toggle__expand__cutout">
      <path d="M0-11h25a1 1 0 0017 13v30H0Z" />
    </clipPath>

    <g>
      <circle class="core" cx="16" cy="16" r="8.4" />
      <path class="rays"
            d="M18.3 3.2c0 1.3-1 2.3-2.3 2.3s-2.3-1-2.3-2.3S14.7.9 16 .9s2.3 1 2.3 2.3zm-4.6 25.6c0-1.3 1-2.3 2.3-2.3s2.3 1 2.3 2.3-1 2.3-2.3 2.3-2.3-1-2.3-2.3zm15.1-10.5c-1.3 0-2.3-1-2.3-2.3s1-2.3 2.3-2.3 2.3 1 2.3 2.3-1 2.3-2.3 2.3zM3.2 13.7c1.3 0 2.3 1 2.3 2.3s-1 2.3-2.3 2.3S.9 17.3.9 16s1-2.3 2.3-2.3zm5.8-7C9 7.9 7.9 9 6.7 9S4.4 8 4.4 6.7s1-2.3 2.3-2.3S9 5.4 9 6.7zm16.3 21c-1.3 0-2.3-1-2.3-2.3s1-2.3 2.3-2.3 2.3 1 2.3 2.3-1 2.3-2.3 2.3zm2.4-21c0 1.3-1 2.3-2.3 2.3S23 7.9 23 6.7s1-2.3 2.3-2.3 2.4 1 2.4 2.3zM6.7 23C8 23 9 24 9 25.3s-1 2.3-2.3 2.3-2.3-1-2.3-2.3 1-2.3 2.3-2.3z" />
      <circle class="cut" cx="16" cy="16" r="8.4" />
    </g>
  </svg>
</div>
    </div>
  </header>

  <div class="app wrap">
    <section class="controls">
  <div class="input-wrap">
    <textarea
      id="report"
      spellcheck="false"
      placeholder="Paste or type a 1H NMR report line (ACS format), e.g. “1H NMR (500 MHz, CDCl3) δ …”. Then press Analyze."
    ></textarea>

    <button id="analyze" type="button" class="btn-raise docked" title="Analyze">
      <span class="button_top">Analyze</span>
    </button>
  </div>
</section>

    <section class="plot-panel">
      <div class="plot-hint">Drag axis to zoom x • Scroll to zoom y • F: x-reset • Y: y-reset • R: full reset • C: crosshair</div>
      <canvas id="plot"></canvas>
      <canvas id="overlay"></canvas>
      <div id="coords" class="coords hidden"></div>
    </section>

    <div class="meta">
      <span id="meta"></span>
      <span id="error" class="err"></span>
    </div>

    <section class="bottom">
      <div id="stats" class="panel">
        <div class="panel-title">Summary</div>
        <div class="statrow"><span>Solvent</span><strong id="stat-solv">–</strong></div>
        <div class="statrow"><span>MHz</span><strong id="stat-mhz">–</strong></div>
        <div class="statrow"><span>Total nuclei</span><strong id="stat-nuclei">–</strong></div>
        <div class="statrow"><span>Total signals</span><strong id="stat-signals">–</strong></div>
        <div class="statrow"><span>Trace impurity matches</span><strong id="stat-imp">–</strong></div>
        <div class="statrow small note">Impurity matching uses solvent-specific references (Fulmer 2010; Gottlieb 1997).</div>
      </div>

      <div id="signals" class="panel">
        <div class="panel-title">Signals</div>
        <div class="table-wrap">
          <table id="sig-table">
            <thead>
              <tr>
                <th>δ (ppm)</th>
                <th>mult</th>
                <th>J (Hz)</th>
                <th>int</th>
                <th>identity</th>
              </tr>
            </thead>
            <tbody id="sig-tbody"></tbody>
          </table>
        </div>
      </div>
    </section>
  </div>

  <div id="issues" style="display:none"><ul id="issue-list"></ul></div>

  <script src="app.js"></script>
  <script>
    (function(){
      const key='nmreportchecker-theme';
      const root=document.documentElement;
      const btn=document.querySelector('.theme-toggle');
      const saved=localStorage.getItem(key);
      const prefersDark=window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches;
      if(saved==='dark'||(!saved&&prefersDark)) root.setAttribute('data-theme','dark');
      function repaint(){ try{ if(window.renderer&&typeof renderer.draw==='function') renderer.draw(); } catch(_){} }
      function toggle(){
        const isDark=root.getAttribute('data-theme')==='dark';
        const next=isDark?'':'dark';
        if(next) root.setAttribute('data-theme',next); else root.removeAttribute('data-theme');
        localStorage.setItem(key,next||'light');
        repaint();
      }
      btn.addEventListener('click',toggle);
      btn.addEventListener('keydown',e=>{ if(e.key==='Enter'||e.key===' ') { e.preventDefault(); toggle(); }});
    })();
  </script>
</body>
</html>
